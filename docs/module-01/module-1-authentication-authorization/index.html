<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-module-01/module-1-authentication-authorization" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Module 1: Add Authentication and Authorization | Serverless Security Workshop</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/img/aws-logo.png"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/img/aws-logo.png"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/docs/module-01/module-1-authentication-authorization"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Module 1: Add Authentication and Authorization | Serverless Security Workshop"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/img/aws-logo.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/docs/module-01/module-1-authentication-authorization"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/module-01/module-1-authentication-authorization" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/module-01/module-1-authentication-authorization" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Module 1: Add Authentication and Authorization","item":"https://your-docusaurus-site.example.com/docs/module-01/module-1-authentication-authorization"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Serverless Security Workshop RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Serverless Security Workshop Atom Feed"><link rel="stylesheet" href="/assets/css/styles.e9f0cf4c.css">
<script src="/assets/js/runtime~main.93d102ee.js" defer="defer"></script>
<script src="/assets/js/main.f58791e0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/aws-logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/aws-logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/aws-logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Serverless Security Workshop</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Modules</a><a class="navbar__item navbar__link" href="/contributor">Contributors</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/khanhquoc4114/serverless-security-workshop" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro"><span title="Serverless Security Workshop" class="linkLabel_WmDU">Serverless Security Workshop</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-00/module-0-initial-setup"><span title="Module 0: Initial Setup" class="categoryLinkLabel_W154">Module 0: Initial Setup</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/module-01/module-1-authentication-authorization"><span title="Module 1: Add Authentication and Authorization" class="categoryLinkLabel_W154">Module 1: Add Authentication and Authorization</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/module-01/module-1-authentication-authorization"><span title="Module 1: Add Authentication and Authorization" class="linkLabel_WmDU">Module 1: Add Authentication and Authorization</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-02/module-2-lambda-iam"><span title="Module 2: Lambda IAM" class="categoryLinkLabel_W154">Module 2: Lambda IAM</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-03/module-3-verified-permissions"><span title="Module 3: Amazon Verified Permissions" class="categoryLinkLabel_W154">Module 3: Amazon Verified Permissions</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-04/module-4-secrets"><span title="Module 4: Secrets" class="categoryLinkLabel_W154">Module 4: Secrets</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-05/module-5-input-validation"><span title="Module 5: Input validation on API Gateway" class="categoryLinkLabel_W154">Module 5: Input validation on API Gateway</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-06/module-6-dependency-vulnerability"><span title="Module 6: Dependency Vulnerability" class="categoryLinkLabel_W154">Module 6: Dependency Vulnerability</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-07/module-7-amazon-inspector"><span title="Module 7: Amazon Inspector" class="categoryLinkLabel_W154">Module 7: Amazon Inspector</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-08/module-8-encryption"><span title="Module 8: Encryption in Transit" class="categoryLinkLabel_W154">Module 8: Encryption in Transit</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-09/module-9-usage-plans"><span title="Module 9: Usage Plans" class="categoryLinkLabel_W154">Module 9: Usage Plans</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-10/module-10-waf"><span title="Module 10: WAF" class="categoryLinkLabel_W154">Module 10: WAF</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-12/module-12-xray"><span title="Module 12: X-Ray" class="categoryLinkLabel_W154">Module 12: X-Ray</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/clean-up-resources/resource-cleanup"><span title="Clean up resources" class="categoryLinkLabel_W154">Clean up resources</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Module 1: Add Authentication and Authorization</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Module 1: Add Authentication and Authorization</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Module 1: Add Authentication and Authorization</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview" translate="no">​</a></h2>
<p>The serverless app deployed in Module 0 is now open to anyone in the world to access. Attackers can submit any number of unicorn customizations and we have no way of knowing who really made the request.</p>
<p>To lock down access to the API to only trusted partners, we must add authentication and authorization to the API.</p>
<p>In this module, we will use <strong>OAuth Client Credentials flow</strong> with <strong>Amazon Cognito</strong> as the authorization server, and leverage <strong>Lambda Authorizer</strong> for API Gateway to inspect tokens and determine access policies based on token claims.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="architecture">Architecture<a href="#architecture" class="hash-link" aria-label="Direct link to Architecture" title="Direct link to Architecture" translate="no">​</a></h2>
<p>By the end of this module, your architecture will look like this:</p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-17-39-cccbda72353fa78c5d2b4dd89529653a.png" width="2090" height="1234" class="img_ev3q"></p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="module-1a-cognito-user-pool-setup">Module 1A: Cognito User Pool Setup<a href="#module-1a-cognito-user-pool-setup" class="hash-link" aria-label="Direct link to Module 1A: Cognito User Pool Setup" title="Direct link to Module 1A: Cognito User Pool Setup" translate="no">​</a></h2>
<ol>
<li class="">
<p>Review the Cognito User Pool in the Resources section of <code>src/template.yaml</code></p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="453" height="102" class="img_ev3q"></p>
</li>
<li class="">
<p>Go to the <a href="https://console.aws.amazon.com/cognito/home" target="_blank" rel="noopener noreferrer" class="">AWS Cognito Console</a></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-22-05-803dd8c484ea4e22f3cc6b15e35a6c73.png" width="1902" height="306" class="img_ev3q"></p>
</li>
<li class="">
<p>Click on the user pool created by the SAM Template named <code>CustomizeUnicorns-users</code></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-22-41-b214252978768ff45557c0ffeb933909.png" width="1310" height="330" class="img_ev3q"></p>
</li>
<li class="">
<p>Under <strong>Branding</strong> left navigation menu, click on <strong>Domain</strong> to set up a unique Cognito domain. Click <strong>Actions</strong>, then select <strong>Create Cognito domain</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-23-28-aae7b2292151baf28e3fe6de65c8573d.png" width="1910" height="915" class="img_ev3q"></p>
</li>
<li class="">
<p>Enter a unique domain name (e.g., <code>custom-unicorn-domain</code>) and click <strong>Create Cognito domain</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-29-27-a67349d9428b1bbc0e53802d4f0834bd.png" width="1910" height="915" class="img_ev3q"></p>
</li>
<li class="">
<p>Note down the full domain name in the format <code>https://&lt;your-custom-name&gt;.auth.&lt;aws-region&gt;.amazoncognito.com</code></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-31-38-3336bae9112e919ed03cc81a0901f9eb.png" width="1910" height="915" class="img_ev3q"></p>
</li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="module-1b-authorization-scopes">Module 1B: Authorization Scopes<a href="#module-1b-authorization-scopes" class="hash-link" aria-label="Direct link to Module 1B: Authorization Scopes" title="Direct link to Module 1B: Authorization Scopes" translate="no">​</a></h2>
<ol>
<li class="">
<p>Go to <strong>Branding &gt; Domain</strong> on the left navigation menu</p>
</li>
<li class="">
<p>Click <strong>Resource servers</strong> section and select <strong>Create Resource Server</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-34-50-afa7fc0a03e79392d343b819b8905281.png" width="1910" height="915" class="img_ev3q"></p>
</li>
<li class="">
<p>Enter the following details:</p>
<ul>
<li class=""><strong>Resource Server Name</strong>: <code>WildRydes</code></li>
<li class=""><strong>Resource Server Identifier</strong>: <code>WildRydes</code></li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-36-20-9be9d3ba4d7bad7a9d029c3f6de221b8.png" width="1368" height="411" class="img_ev3q"></p>
</li>
<li class="">
<p>In the <strong>Scopes</strong> section, add two scopes:</p>
<ul>
<li class=""><strong>Scope name</strong>: <code>CustomizeUnicorn</code> (for 3rd party partners to customize unicorns)</li>
<li class=""><strong>Scope name</strong>: <code>ManagePartners</code> (for internal apps/admin to register partner companies)</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-36-36-ae330b6b947c4f5591223b0a9bcc7bd7.png" width="1367" height="273" class="img_ev3q"></p>
</li>
<li class="">
<p>Click <strong>Create resource server</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-36-57-fd3a08070c7f6ff1ad15a01833724690.png" width="1910" height="915" class="img_ev3q"></p>
</li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="module-1c-admin-account">Module 1C: Admin Account<a href="#module-1c-admin-account" class="hash-link" aria-label="Direct link to Module 1C: Admin Account" title="Direct link to Module 1C: Admin Account" translate="no">​</a></h2>
<ol>
<li class="">
<p>In the Cognito console, go to <strong>Applications &gt; App clients</strong>. Click <strong>Create app client</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-39-45-0b360c100f5d2acb7ee4deb11ce4263e.png" width="1910" height="915" class="img_ev3q"></p>
</li>
<li class="">
<p>Select <strong>Machine-to-machine application</strong> as the Application Type. Enter <code>Admin</code> for the app client name and click <strong>Create app client</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-40-50-5429f0f9301e40c37132a8b697e74553.png" width="1910" height="915" class="img_ev3q"></p>
</li>
<li class="">
<p>On the <strong>Admin</strong> client detail page, click on the <strong>Login pages</strong> tab. Click <strong>Edit</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-42-07-39a130f0d668eeb836f493a99c87a750.png" width="1910" height="915" class="img_ev3q"></p>
</li>
<li class="">
<p>Under <strong>Managed login pages</strong>, click <strong>add callback url</strong> and enter <code>https://aws.amazon.com</code></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-44-28-62b4ce7bce71d1079be921cb56e01371.png" width="1237" height="296" class="img_ev3q"></p>
</li>
<li class="">
<p>Verify <strong>Client Credentials</strong> OAuth 2.0 grant type is selected</p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-45-03-0a0338051bc51c4b84498725b8423f90.png" width="1280" height="176" class="img_ev3q"></p>
</li>
<li class="">
<p>Under <strong>Custom scopes</strong>, select <code>WildRydes/ManagePartners</code></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-45-17-2ac5714498afff1bd2637af45b19d2ba.png" width="1256" height="156" class="img_ev3q"></p>
</li>
<li class="">
<p>Scroll down and click <strong>Save Changes</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-46-05-a41f3de0466b256cda5c8b05c133250d.png" width="1910" height="915" class="img_ev3q"></p>
</li>
<li class="">
<p>Under the <strong>App client information</strong> section, click the radio button <strong>Show client secret</strong></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-46-59-1b6bc8b567a826c94c8e433184073fa2.png" width="1910" height="915" class="img_ev3q"></p>
</li>
<li class="">
<p>Copy the <strong>Client ID</strong> and <strong>Client secret</strong> for later use</p>
</li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="module-1d-lambda-authorizer">Module 1D: Lambda Authorizer<a href="#module-1d-lambda-authorizer" class="hash-link" aria-label="Direct link to Module 1D: Lambda Authorizer" title="Direct link to Module 1D: Lambda Authorizer" translate="no">​</a></h2>
<ol>
<li class="">
<p>Review the Lambda authorizer workflow diagram</p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-50-37-592d140349ecee0c80ae1f8d2e721fbe.png" width="1273" height="699" class="img_ev3q"></p>
</li>
<li class="">
<p>Review the DynamoDB table for ClientID to Company ID mapping in <code>src/template.yaml</code></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-52-27-be98f6f657c61d0960d5111e4b5830f8.png" width="679" height="196" class="img_ev3q"></p>
</li>
<li class="">
<p>Review the Lambda authorizer code in <code>src/authorizer/index.js</code></p>
</li>
<li class="">
<p>Install Node.js dependencies in the <code>src/authorizer</code> folder:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /Workshop/src/authorizer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm install</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-54-31-a733822888bce4a982606496058d78f7.png" width="1219" height="572" class="img_ev3q"></p>
</li>
<li class="">
<p>Add the Custom Authorizer Function to the Resources section of <code>src/template.yaml</code></p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">CustomAuthorizerFunction</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">Type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> AWS</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">Serverless</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">Properties</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">CodeUri</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> authorizer/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">Runtime</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nodejs22.x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">Handler</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> index.handler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">Policies</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">Statement</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">Effect</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">Action</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;dynamodb:*&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">Resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;*&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">Environment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">Variables</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">USER_POOL_ID</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token tag" style="color:#00009f">!Ref</span><span class="token plain"> CognitoUserPool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">PARTNER_DDB_TABLE</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token tag" style="color:#00009f">!Ref</span><span class="token plain"> PartnerDDBTable</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-57-35-074e4566b5951f98031a49967d726e05.png" width="1920" height="1032" class="img_ev3q"></p>
</li>
<li class="">
<p>Add the API Gateway Authorizer IAM Role to <code>src/template.yaml</code></p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">ApiGatewayAuthorizerRole</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">Type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> AWS</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">IAM</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">Role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">Properties</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">AssumeRolePolicyDocument</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">Version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2012-10-17&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">Statement</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">Effect</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Allow&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">Principal</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token key atrule" style="color:#00a4db">Service</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;apigateway.amazonaws.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">Action</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> sts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">AssumeRole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">Policies</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">PolicyName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;InvokeAuthorizerFunction&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token key atrule" style="color:#00a4db">PolicyDocument</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">Version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2012-10-17&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">Statement</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">Effect</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Allow&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token key atrule" style="color:#00a4db">Action</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> lambda</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">InvokeAsync</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> lambda</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">InvokeFunction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token key atrule" style="color:#00a4db">Resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token tag" style="color:#00009f">!Sub</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">CustomAuthorizerFunction.Arn</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-20-58-46-275ee52e74eeb459d942d368914356fb.png" width="1920" height="1032" class="img_ev3q"></p>
</li>
<li class="">
<p>Find the Swagger definition in <code>src/template.yaml</code> and locate the <code>### TODO: add authorizer</code> section</p>
</li>
<li class="">
<p>Replace the <code>### TODO: add authorizer</code> section with the security definitions:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">securityDefinitions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">CustomAuthorizer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apiKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Authorization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">in</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> header</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">x-amazon-apigateway-authtype</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> custom</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">x-amazon-apigateway-authorizer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">authorizerUri</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">Fn::Sub</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> arn</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">aws</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">apigateway</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">$</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">AWS</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">Region</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">lambda</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">path/2015</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">03</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">31/functions/$</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">CustomAuthorizerFunction.Arn</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">/invocations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">authorizerCredentials</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">Fn::Sub</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">ApiGatewayAuthorizerRole.Arn</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">authorizerResultTtlInSeconds</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-21-01-58-00eda992642db38876ecc31b9d943f6f.png" width="1920" height="1032" class="img_ev3q"></p>
</li>
<li class="">
<p>Uncomment the security lines in each API method in the <code>paths</code> section. Change the comment lines to active code:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">security</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">CustomAuthorizer</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-21-03-20-e322681131a859eccee57557d693d544.png" width="1182" height="285" class="img_ev3q"></p>
</li>
<li class="">
<p>Save the <code>src/template.yaml</code> file</p>
</li>
<li class="">
<p>Navigate back to the <code>src</code> folder and validate the template:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sam validate -t template.yaml --region $REGION</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="858" height="67" class="img_ev3q"></p>
</li>
<li class="">
<p>Deploy the updates using CloudFormation:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aws cloudformation package --output-template-file packaged.yaml --template-file template.yaml --s3-bucket $DeploymentS3Bucket --s3-prefix securityworkshop --region $REGION &amp;&amp; aws cloudformation deploy --template-file packaged.yaml --stack-name CustomizeUnicorns --region $REGION --capabilities CAPABILITY_IAM</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-21-24-09-178713aa43468d08a32b14e9dea9e25f.png" width="1050" height="329" class="img_ev3q"></p>
</li>
<li class="">
<p>After deployment completes, go to the <a href="https://console.aws.amazon.com/apigateway/home" target="_blank" rel="noopener noreferrer" class="">AWS API Gateway Console</a>. Click into the <code>CustomizeUnicorns</code> API and verify the Authorization is set to <code>CustomAuthorizer</code> in Method Request</p>
</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-29-19-40-35-4cf0e8fd5b342c31e893bb1f4626c894.png" width="1910" height="915" class="img_ev3q"></p>
<ol start="14">
<li class="">Test the API using the VS Code Server API Client. You should now receive <strong>401 Unauthorized</strong> errors</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-21-54-05-7b3d49e6f62f0600846f374cd1355d80.png" width="1291" height="838" class="img_ev3q"></p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="module-1e-partner-companies">Module 1E: Partner Companies<a href="#module-1e-partner-companies" class="hash-link" aria-label="Direct link to Module 1E: Partner Companies" title="Direct link to Module 1E: Partner Companies" translate="no">​</a></h2>
<ol>
<li class="">
<p>Open the API Client preview (Show Preview on <code>src/apiclient/index.html</code>)</p>
</li>
<li class="">
<p>Expand &quot;Module 1E: Partner Companies&quot; in the client</p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-22-01-48-29871f5140b490ef4ffbf6aa38b53b54.png" width="1920" height="1032" class="img_ev3q"></p>
</li>
<li class="">
<p>Ensure the base URL is your API Gateway endpoint. Fill Access Token URL (<code>&lt;cognito-domain&gt;/oauth2/token</code>), paste Admin <code>Client ID</code> and <code>Client Secret</code></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-22-07-56-17b2927beb5c021fc536fe492c48767b.png" width="1920" height="1032" class="img_ev3q"></p>
</li>
<li class="">
<p>Click &quot;Get Access Token&quot; and verify token is returned</p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-22-09-40-b4c4ce05da24c9fbb7ef54dc771587f8.png" width="1920" height="1032" class="img_ev3q"></p>
</li>
<li class="">
<p>In &quot;Register Partner&quot;, keep URL path <code>/partners</code>, set body, then Send</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Cherry Company&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Copy the returned <code>ClientId</code> and <code>ClientSecret</code> for the new partner</p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-22-48-41-941b40a6110ff2c1794a84c7e56952e6.png" width="1920" height="1032" class="img_ev3q"></p>
</li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="module-1f-customize-unicorns">Module 1F: Customize Unicorns<a href="#module-1f-customize-unicorns" class="hash-link" aria-label="Direct link to Module 1F: Customize Unicorns" title="Direct link to Module 1F: Customize Unicorns" translate="no">​</a></h2>
<ol>
<li class="">
<p>Expand &quot;Module 1F: Customize Unicorns&quot; in the API Client</p>
</li>
<li class="">
<p>Copy the partner company&#x27;s <code>Client ID</code> and <code>Client Secret</code> from Module 1E into the textboxes</p>
</li>
<li class="">
<p>Click &quot;Get Access Token&quot; to request a token for the partner company</p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-22-56-56-6f335bf90f5d3f1a3e85ff52d8e75fe2.png" width="1920" height="1032" class="img_ev3q"></p>
</li>
<li class="">
<p>Verify the new Access Token is returned in the Response section</p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-22-57-41-f72a9fd77ab9be2dc3e367ec43dfee57.png" width="1920" height="1032" class="img_ev3q"></p>
</li>
<li class="">
<p>Scroll down to the &quot;Create Customization&quot; POST request (path <code>/customizations</code>)</p>
</li>
<li class="">
<p>Enter the following JSON in the Body JSON textbox:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Cherry-themed unicorn&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;imageUrl&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://en.wikipedia.org/wiki/Cherry#/media/File:Cherry_Stella444.jpg&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;sock&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;horn&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;glasses&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;cape&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;4&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Click the &quot;Send&quot; button to create the customization</p>
</li>
<li class="">
<p>Verify the response contains the <code>customUnicornId</code></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-27-23-20-41-8ff4a693db957b1765ebcb122408676b.png" width="1920" height="1032" class="img_ev3q"></p>
</li>
</ol>
<hr></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/khanhquoc4114/serverless-security-workshop/tree/main/packages/create-docusaurus/templates/shared/docs/module-01/module-1-authentication-authorization.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/module-00/module-0-initial-setup"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Module 0: Initial Setup</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/module-02/module-2-lambda-iam"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Module 2: Lambda IAM</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#architecture" class="table-of-contents__link toc-highlight">Architecture</a></li><li><a href="#module-1a-cognito-user-pool-setup" class="table-of-contents__link toc-highlight">Module 1A: Cognito User Pool Setup</a></li><li><a href="#module-1b-authorization-scopes" class="table-of-contents__link toc-highlight">Module 1B: Authorization Scopes</a></li><li><a href="#module-1c-admin-account" class="table-of-contents__link toc-highlight">Module 1C: Admin Account</a></li><li><a href="#module-1d-lambda-authorizer" class="table-of-contents__link toc-highlight">Module 1D: Lambda Authorizer</a></li><li><a href="#module-1e-partner-companies" class="table-of-contents__link toc-highlight">Module 1E: Partner Companies</a></li><li><a href="#module-1f-customize-unicorns" class="table-of-contents__link toc-highlight">Module 1F: Customize Unicorns</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Built with ❤️ at AWS. <br> Copyright © 2026 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>