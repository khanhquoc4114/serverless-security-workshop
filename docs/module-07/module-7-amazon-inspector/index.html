<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-module-07/module-7-amazon-inspector" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Module 7: Amazon Inspector | Serverless Security Workshop</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/img/aws-logo.png"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/img/aws-logo.png"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/docs/module-07/module-7-amazon-inspector"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Module 7: Amazon Inspector | Serverless Security Workshop"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/img/aws-logo.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/docs/module-07/module-7-amazon-inspector"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/module-07/module-7-amazon-inspector" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/module-07/module-7-amazon-inspector" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Module 7: Amazon Inspector","item":"https://your-docusaurus-site.example.com/docs/module-07/module-7-amazon-inspector"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Serverless Security Workshop RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Serverless Security Workshop Atom Feed"><link rel="stylesheet" href="/assets/css/styles.e9f0cf4c.css">
<script src="/assets/js/runtime~main.93d102ee.js" defer="defer"></script>
<script src="/assets/js/main.f58791e0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/aws-logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/aws-logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/aws-logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Serverless Security Workshop</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Modules</a><a class="navbar__item navbar__link" href="/contributor">Contributors</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/khanhquoc4114/serverless-security-workshop" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro"><span title="Serverless Security Workshop" class="linkLabel_WmDU">Serverless Security Workshop</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-00/module-0-initial-setup"><span title="Module 0: Initial Setup" class="categoryLinkLabel_W154">Module 0: Initial Setup</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-01/module-1-authentication-authorization"><span title="Module 1: Add Authentication and Authorization" class="categoryLinkLabel_W154">Module 1: Add Authentication and Authorization</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-02/module-2-lambda-iam"><span title="Module 2: Lambda IAM" class="categoryLinkLabel_W154">Module 2: Lambda IAM</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-03/module-3-verified-permissions"><span title="Module 3: Amazon Verified Permissions" class="categoryLinkLabel_W154">Module 3: Amazon Verified Permissions</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-04/module-4-secrets"><span title="Module 4: Secrets" class="categoryLinkLabel_W154">Module 4: Secrets</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-05/module-5-input-validation"><span title="Module 5: Input validation on API Gateway" class="categoryLinkLabel_W154">Module 5: Input validation on API Gateway</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-06/module-6-dependency-vulnerability"><span title="Module 6: Dependency Vulnerability" class="categoryLinkLabel_W154">Module 6: Dependency Vulnerability</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/module-07/module-7-amazon-inspector"><span title="Module 7: Amazon Inspector" class="categoryLinkLabel_W154">Module 7: Amazon Inspector</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/module-07/module-7-amazon-inspector"><span title="Module 7: Amazon Inspector" class="linkLabel_WmDU">Module 7: Amazon Inspector</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-08/module-8-encryption"><span title="Module 8: Encryption in Transit" class="categoryLinkLabel_W154">Module 8: Encryption in Transit</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-09/module-9-usage-plans"><span title="Module 9: Usage Plans" class="categoryLinkLabel_W154">Module 9: Usage Plans</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-10/module-10-waf"><span title="Module 10: WAF" class="categoryLinkLabel_W154">Module 10: WAF</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/module-12/module-12-xray"><span title="Module 12: X-Ray" class="categoryLinkLabel_W154">Module 12: X-Ray</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/clean-up-resources/resource-cleanup"><span title="Clean up resources" class="categoryLinkLabel_W154">Clean up resources</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Module 7: Amazon Inspector</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Module 7: Amazon Inspector</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Module 7: Amazon Inspector</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview" translate="no">​</a></h2>
<p>Modern distributed applications have many contributors, and sometimes developers write bad code. We have all seen this, right?</p>
<p>Wouldn&#x27;t it be great if there was a service that assists development teams and identifies when code needs to be updated to reflect a set of security standards?</p>
<p>In this module, we are going to use <strong>Amazon Inspector</strong> to evaluate a few Lambda Functions that have been deployed and see how we can quickly update and mitigate risk.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-is-amazon-inspector">What is Amazon Inspector?<a href="#what-is-amazon-inspector" class="hash-link" aria-label="Direct link to What is Amazon Inspector?" title="Direct link to What is Amazon Inspector?" translate="no">​</a></h3>
<p>Amazon Inspector is a <strong>vulnerability management service</strong> that continuously scans your AWS workloads for software vulnerabilities and unintended network exposure.</p>
<p>Amazon Inspector automatically discovers and scans:</p>
<ul>
<li class="">Running <strong>Amazon EC2 instances</strong></li>
<li class="">Container images in <strong>Amazon Elastic Container Registry (Amazon ECR)</strong></li>
<li class=""><strong>AWS Lambda functions</strong></li>
</ul>
<p>For known software vulnerabilities and unintended network exposure.</p>
<p>For more information on Amazon Inspector services, check out the <a href="https://docs.aws.amazon.com/inspector/latest/user/what-is-inspector.html" target="_blank" rel="noopener noreferrer" class="">Amazon Inspector Documentation</a>.</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-1-setup-amazon-inspector">Step 1: Setup Amazon Inspector<a href="#step-1-setup-amazon-inspector" class="hash-link" aria-label="Direct link to Step 1: Setup Amazon Inspector" title="Direct link to Step 1: Setup Amazon Inspector" translate="no">​</a></h2>
<p>Setting up Amazon Inspector is very straightforward. Let&#x27;s setup Amazon Inspector and configure the service to scan our Lambda functions.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="navigate-to-inspector-console">Navigate to Inspector Console<a href="#navigate-to-inspector-console" class="hash-link" aria-label="Direct link to Navigate to Inspector Console" title="Direct link to Navigate to Inspector Console" translate="no">​</a></h3>
<ol>
<li class="">
<p>In the AWS Console, search for <code>inspector</code></p>
</li>
<li class="">
<p>From the services menu, select <strong>Amazon Inspector</strong></p>
</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-29-16-28-46-98bb1884823cc6076bae189424b9a3a4.png" width="1523" height="915" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="activate-inspector">Activate Inspector<a href="#activate-inspector" class="hash-link" aria-label="Direct link to Activate Inspector" title="Direct link to Activate Inspector" translate="no">​</a></h3>
<ol start="3">
<li class="">
<p>Once the Amazon Inspector console page has loaded, click <strong>Get Started</strong></p>
</li>
<li class="">
<p>When the Amazon Inspector Dashboard loads, click the <strong>Activate Inspector</strong> button</p>
</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-29-16-30-42-0f7c8c77d99cf1d63efac215620f0228.png" width="1784" height="915" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="configure-lambda-scanning">Configure Lambda Scanning<a href="#configure-lambda-scanning" class="hash-link" aria-label="Direct link to Configure Lambda Scanning" title="Direct link to Configure Lambda Scanning" translate="no">​</a></h3>
<ol start="5">
<li class="">
<p>Selecting the types of resources that we want Amazon Inspector to evaluate is done in <strong>Account management</strong></p>
</li>
<li class="">
<p>Click <strong>Account Management</strong> to configure which resources to scan and evaluate</p>
</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-29-16-33-11-584e2550d19d0cea0e99919bd0c5ef49.png" width="1493" height="915" class="img_ev3q"></p>
<ol start="7">
<li class="">In the Account Management Setup screen:</li>
</ol>
<ul>
<li class="">Click the orange <strong>activate</strong> button</li>
<li class="">Check the mark next to <strong>AWS Lambda Standard scanning + AWS Lambda Code scanning</strong></li>
<li class="">Click <strong>submit</strong></li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-29-16-34-05-c5e7c81cfbd9f1ab6c64e25758de4a82.png" width="1493" height="915" class="img_ev3q"></p>
<blockquote>
<p><strong>Note:</strong> With this option enabled, Amazon Inspector scans for package dependencies and also scans your proprietary application code in Lambda for code vulnerabilities. The code scanning feature is only available in certain AWS Regions.</p>
</blockquote>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="verify-activation">Verify Activation<a href="#verify-activation" class="hash-link" aria-label="Direct link to Verify Activation" title="Direct link to Verify Activation" translate="no">​</a></h3>
<ol start="8">
<li class="">Once activation is complete, you&#x27;ll see a green checkmark in the <strong>AWS Lambda Scanning</strong> column</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-29-16-37-38-60390b08c6001cf6f1814255a659703c.png" width="1545" height="915" class="img_ev3q"></p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-2-understanding-code-inspection">Step 2: Understanding Code Inspection<a href="#step-2-understanding-code-inspection" class="hash-link" aria-label="Direct link to Step 2: Understanding Code Inspection" title="Direct link to Step 2: Understanding Code Inspection" translate="no">​</a></h2>
<p>Amazon Inspector reviews the security and quality of the code written in your Lambda functions. To do this, the service uses the <strong>Amazon CodeGuru Detector Library</strong>, which has trained data across millions of code reviews, to generate findings.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-amazon-inspector-scans-for">What Amazon Inspector Scans For<a href="#what-amazon-inspector-scans-for" class="hash-link" aria-label="Direct link to What Amazon Inspector Scans For" title="Direct link to What Amazon Inspector Scans For" translate="no">​</a></h3>
<p>Amazon Inspector scans the Lambda function code to detect security flaws like:</p>
<ul>
<li class="">Cross-site scripting (XSS)</li>
<li class="">Injection flaws</li>
<li class="">Data leaks</li>
<li class="">Log injection</li>
<li class="">OS command injections</li>
<li class="">Other risk categories in the <strong>OWASP Top 10</strong> and <strong>CWE Top 25</strong></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="benefits">Benefits<a href="#benefits" class="hash-link" aria-label="Direct link to Benefits" title="Direct link to Benefits" translate="no">​</a></h3>
<p>When you enable code scanning, you can focus on building your application while also following current security recommendations.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="supported-runtimes">Supported Runtimes<a href="#supported-runtimes" class="hash-link" aria-label="Direct link to Supported Runtimes" title="Direct link to Supported Runtimes" translate="no">​</a></h3>
<p>At the time of this writing, Amazon Inspector supports scanning:</p>
<ul>
<li class="">Java</li>
<li class="">Node.js</li>
<li class="">Python</li>
<li class="">Go Lambda runtimes</li>
</ul>
<p>For a full list of supported programming language runtimes, see the Amazon Inspector documentation.</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-3-create-vulnerable-lambda-function">Step 3: Create Vulnerable Lambda Function<a href="#step-3-create-vulnerable-lambda-function" class="hash-link" aria-label="Direct link to Step 3: Create Vulnerable Lambda Function" title="Direct link to Step 3: Create Vulnerable Lambda Function" translate="no">​</a></h2>
<p>As a demonstration of the Amazon Inspector code scanning feature, let&#x27;s create a simple Python Lambda function which accidentally overrides the Lambda reserved environment variables and also has an open-to-all socket connection.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="create-the-function">Create the Function<a href="#create-the-function" class="hash-link" aria-label="Direct link to Create the Function" title="Direct link to Create the Function" translate="no">​</a></h3>
<ol>
<li class="">
<p>In the AWS Console, search for <code>lambda</code></p>
</li>
<li class="">
<p>From the services menu, select <strong>Lambda</strong></p>
</li>
<li class="">
<p>Click the orange <strong>Create Function</strong> button</p>
</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-29-16-38-47-cf7ed5392421e607dbdc942b7d6602bf.png" width="1545" height="915" class="img_ev3q"></p>
<ol start="4">
<li class="">Configure the function:</li>
</ol>
<ul>
<li class=""><strong>Function name</strong>: <code>bad-code-function</code></li>
<li class=""><strong>Runtime</strong>: Python 3.11</li>
<li class="">Click the orange <strong>Create Function</strong> button</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-29-16-39-52-2eb9decc9c2fc27273705d5e6dd2f445.png" width="1377" height="915" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-29-16-41-56-d06b23b9391e9eff0fccfe918623d56d.png" width="1377" height="915" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="add-vulnerable-code">Add Vulnerable Code<a href="#add-vulnerable-code" class="hash-link" aria-label="Direct link to Add Vulnerable Code" title="Direct link to Add Vulnerable Code" translate="no">​</a></h3>
<ol start="5">
<li class="">
<p>In the <strong>Code Source</strong> section, copy the code below and paste it into the code window, removing the example code provided</p>
</li>
<li class="">
<p>Click the <strong>Deploy</strong> button to save the code in the Lambda</p>
</li>
</ol>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">lambda_handler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># print(&quot;Scenario 1&quot;);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;_HANDLER&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;hello&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># print(&quot;Scenario 1 ends&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># print(&quot;Scenario 2&quot;);</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    s </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> socket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">socket</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">socket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AF_INET</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> socket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SOCK_STREAM</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># print(&quot;Scenario 2 ends&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;statusCode&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;body&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dumps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Inspector Code Scanning&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> default</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-29-16-42-44-8b1cb63e474d8a17c86fd418ad31b9be.png" width="1377" height="915" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="whats-going-on-here">What&#x27;s Going On Here?<a href="#whats-going-on-here" class="hash-link" aria-label="Direct link to What&#x27;s Going On Here?" title="Direct link to What&#x27;s Going On Here?" translate="no">​</a></h3>
<p><strong>Issue 1: Overriding Reserved Environment Variables</strong></p>
<ul>
<li class="">Overriding reserved environment variables might lead to unexpected behavior or failure of the Lambda function</li>
<li class="">You can learn more about this vulnerability by reviewing the Detector Library documentation</li>
</ul>
<p><strong>Issue 2: Insecure Socket Binding</strong></p>
<ul>
<li class="">A socket connection without an IP address opens the connection to all entities, allowing the function code to potentially access public IPv4 addresses from within the code</li>
<li class="">There can be external dependencies in your code which might reuse the insecure socket connection</li>
<li class="">To learn more about insecure socket binds, see the Detector Library documentation</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-4-review-inspector-findings">Step 4: Review Inspector Findings<a href="#step-4-review-inspector-findings" class="hash-link" aria-label="Direct link to Step 4: Review Inspector Findings" title="Direct link to Step 4: Review Inspector Findings" translate="no">​</a></h2>
<p>Let&#x27;s dive deep and look at the results that Amazon Inspector generated.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="access-findings">Access Findings<a href="#access-findings" class="hash-link" aria-label="Direct link to Access Findings" title="Direct link to Access Findings" translate="no">​</a></h3>
<ol>
<li class="">
<p>Back at the Inspector Dashboard, in the left navigation in the <strong>Findings</strong> section, click <strong>By Lambda function</strong></p>
</li>
<li class="">
<p>Click on the <strong>bad-code-function</strong></p>
</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-29-16-47-07-8be55bb6993d7430c83761bb4805c713.png" width="1910" height="915" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="view-summary">View Summary<a href="#view-summary" class="hash-link" aria-label="Direct link to View Summary" title="Direct link to View Summary" translate="no">​</a></h3>
<ol start="3">
<li class="">At the top of the finding window, you&#x27;ll see a summary of the <strong>Critical</strong>, <strong>High</strong>, and <strong>Medium</strong> findings</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-29-16-48-05-c977a47bae941b9abd674cc5ea643b3f.png" width="1319" height="915" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="review-detailed-findings">Review Detailed Findings<a href="#review-detailed-findings" class="hash-link" aria-label="Direct link to Review Detailed Findings" title="Direct link to Review Detailed Findings" translate="no">​</a></h3>
<ol start="4">
<li class="">
<p>Scrolling down, you&#x27;ll see the specific finding</p>
</li>
<li class="">
<p>Clicking on the tile will drill down and provide additional detail and remediation suggestions</p>
</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-29-16-48-43-cc2bdab70010b49babae43eff45a682d.png" width="1687" height="915" class="img_ev3q"></p>
<ol start="6">
<li class="">Click on the tile and review the detailed suggestions</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-29-16-49-14-8b81cb756bf235d1572be8a44914247b.png" width="526" height="755" class="img_ev3q"></p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="step-5-remediate-the-vulnerabilities">Step 5: Remediate the Vulnerabilities<a href="#step-5-remediate-the-vulnerabilities" class="hash-link" aria-label="Direct link to Step 5: Remediate the Vulnerabilities" title="Direct link to Step 5: Remediate the Vulnerabilities" translate="no">​</a></h2>
<p>Now let&#x27;s see how you can remediate these vulnerabilities according to the suggested remediation.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="understanding-the-issue">Understanding the Issue<a href="#understanding-the-issue" class="hash-link" aria-label="Direct link to Understanding the Issue" title="Direct link to Understanding the Issue" translate="no">​</a></h3>
<p>The code is attempting to change the function handler. AWS recommends that you don&#x27;t try to override reserved Lambda environment variables, because this can lead to unexpected results.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="fix-the-code">Fix the Code<a href="#fix-the-code" class="hash-link" aria-label="Direct link to Fix the Code" title="Direct link to Fix the Code" translate="no">​</a></h3>
<p>For this case, we recommend that you comment out line 8 from the sample code and instead update the Lambda function handler name as outlined below:</p>
<p><strong>To change the Lambda function handler:</strong></p>
<ol>
<li class="">
<p>In the Lambda console, search for and then select your Lambda function</p>
</li>
<li class="">
<p>Scroll down to the <strong>Code Source</strong> section</p>
</li>
<li class="">
<p>Comment out the line <code>os.environ[&#x27;_HANDLER&#x27;] = &#x27;hello&#x27;</code> with a <code>#</code></p>
</li>
<li class="">
<p>Click <strong>Deploy</strong></p>
</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-29-16-50-55-45da5579ead56e04c4b242e4b319f181.png" width="1377" height="915" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="verify-fix">Verify Fix<a href="#verify-fix" class="hash-link" aria-label="Direct link to Verify Fix" title="Direct link to Verify Fix" translate="no">​</a></h3>
<ol start="5">
<li class="">
<p>Amazon Inspector will automatically detect the changes that are made to fix the issues, and change the status of the finding to <strong>closed</strong></p>
</li>
<li class="">
<p>By changing the findings filter to <strong>Show all</strong>, you can see active and closed findings</p>
</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-29-16-52-25-3bec9c6923d157ff8cb2bc3f5d5a3c76.png" width="1687" height="915" class="img_ev3q"></p>
<hr></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/khanhquoc4114/serverless-security-workshop/tree/main/packages/create-docusaurus/templates/shared/docs/module-07/module-7-amazon-inspector.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/module-06/module-6-dependency-vulnerability"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Module 6: Dependency Vulnerability</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/module-08/module-8-encryption"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Module 8: Encryption in Transit</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a><ul><li><a href="#what-is-amazon-inspector" class="table-of-contents__link toc-highlight">What is Amazon Inspector?</a></li></ul></li><li><a href="#step-1-setup-amazon-inspector" class="table-of-contents__link toc-highlight">Step 1: Setup Amazon Inspector</a><ul><li><a href="#navigate-to-inspector-console" class="table-of-contents__link toc-highlight">Navigate to Inspector Console</a></li><li><a href="#activate-inspector" class="table-of-contents__link toc-highlight">Activate Inspector</a></li><li><a href="#configure-lambda-scanning" class="table-of-contents__link toc-highlight">Configure Lambda Scanning</a></li><li><a href="#verify-activation" class="table-of-contents__link toc-highlight">Verify Activation</a></li></ul></li><li><a href="#step-2-understanding-code-inspection" class="table-of-contents__link toc-highlight">Step 2: Understanding Code Inspection</a><ul><li><a href="#what-amazon-inspector-scans-for" class="table-of-contents__link toc-highlight">What Amazon Inspector Scans For</a></li><li><a href="#benefits" class="table-of-contents__link toc-highlight">Benefits</a></li><li><a href="#supported-runtimes" class="table-of-contents__link toc-highlight">Supported Runtimes</a></li></ul></li><li><a href="#step-3-create-vulnerable-lambda-function" class="table-of-contents__link toc-highlight">Step 3: Create Vulnerable Lambda Function</a><ul><li><a href="#create-the-function" class="table-of-contents__link toc-highlight">Create the Function</a></li><li><a href="#add-vulnerable-code" class="table-of-contents__link toc-highlight">Add Vulnerable Code</a></li><li><a href="#whats-going-on-here" class="table-of-contents__link toc-highlight">What&#39;s Going On Here?</a></li></ul></li><li><a href="#step-4-review-inspector-findings" class="table-of-contents__link toc-highlight">Step 4: Review Inspector Findings</a><ul><li><a href="#access-findings" class="table-of-contents__link toc-highlight">Access Findings</a></li><li><a href="#view-summary" class="table-of-contents__link toc-highlight">View Summary</a></li><li><a href="#review-detailed-findings" class="table-of-contents__link toc-highlight">Review Detailed Findings</a></li></ul></li><li><a href="#step-5-remediate-the-vulnerabilities" class="table-of-contents__link toc-highlight">Step 5: Remediate the Vulnerabilities</a><ul><li><a href="#understanding-the-issue" class="table-of-contents__link toc-highlight">Understanding the Issue</a></li><li><a href="#fix-the-code" class="table-of-contents__link toc-highlight">Fix the Code</a></li><li><a href="#verify-fix" class="table-of-contents__link toc-highlight">Verify Fix</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Built with ❤️ at AWS. <br> Copyright © 2026 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>